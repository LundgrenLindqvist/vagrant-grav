<VirtualHost *:80>
  ServerAdmin webmaster@localhost
  ServerName grav.dev
  DocumentRoot /vagrant/grav-admin

  # correct caching issue where edited images do not refresh http://www.mabishu.com/blog/2013/05/07/solving-caching-issues-with-vagrant-on-vboxsf/
  EnableSendfile off

  <Directory /vagrant/grav-admin>
    RewriteEngine On
    Options Indexes FollowSymLinks
    DirectoryIndex index.php index.html index.htm
    AllowOverride None
    Require all granted

    RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
    RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
    RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
    RewriteRule .* index.php [F]

    RewriteCond %{REQUEST_URI} !^/index\.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule .* index.php [L]

    RewriteRule ^(.git|cache|bin|logs|backup|webserver-configs|tests)/(.*) error [F]
    RewriteRule ^(system|vendor)/(.*)\.(txt|xml|md|html|yaml|php|pl|py|cgi|twig|sh|bat)$ error [F]
    RewriteRule ^(user)/(.*)\.(txt|md|yaml|php|pl|py|cgi|twig|sh|bat)$ error [F]
    RewriteRule \.md$ error [F]
    RewriteRule (^\.|/\.) - [F]
    RewriteRule ^(LICENSE.txt|composer.lock|composer.json|\.htaccess)$ error [F]
  </Directory>

  ErrorLog ${APACHE_LOG_DIR}/grav.error.log

  # Possible values include: debug, info, notice, warn, error, crit,
  # alert, emerg.
  LogLevel warn

  CustomLog ${APACHE_LOG_DIR}/grav.access.log combined
</VirtualHost>
